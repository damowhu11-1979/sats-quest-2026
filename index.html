<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>KS2 SATs 2026 – Perfect 2022 Look</title>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  *{box-sizing:border-box;}
  body,html{margin:0;padding:0;height:100%;font-family:Arial,Helvetica,sans-serif;background:white;overflow:hidden;}
  .page{height:100vh;display:flex;flex-direction:column;}

  /* Header – exactly like 2022 papers */
  .header{background:#000;color:white;padding:12px 20px;text-align:center;font-weight:bold;font-size:16px;border-radius:0 0 20px 20px;}
  .ks2{background:#005eb8;color:white;padding:12px 60px;border-radius:40px;font-size:36px;display:inline-block;margin:20px auto;font-weight:bold;}

  /* Titles */
  .title{font-size:58px;font-weight:bold;text-align:center;margin:30px 0 10px;}
  .subtitle{font-size:32px;text-align:center;margin-bottom:40px;}

  /* Name input – single line only */
  .name-box{width:80%;max-width:600px;margin:40px auto;}
  .name-box input{width:100%;border:3px solid black;padding:20px;font-size:28px;text-align:center;border-radius:8px;}

  /* Buttons */
  button{background:#005eb8;color:white;border:none;border-radius:12px;padding:18px 40px;font-size:28px;cursor:pointer;margin:15px auto;display:block;width:80%;max-width:500px;}
  button:hover{background:#003087;}
  .big-btn{padding:22px 40px !important;font-size:32px !important;}

  /* Game screen */
  #timer{font-size:48px;color:#c00;text-align:center;margin:15px 0;font-weight:bold;}
  .progress{width:90%;max-width:800px;height:40px;background:#ddd;border-radius:20px;margin:10px auto;overflow:hidden;position:relative;}
  .bar{height:100%;width:0%;background:linear-gradient(90deg,#ff006e,#8338ec,#3a86ff,#06ffa5,#ffba08);transition:width 0.6s;}
  .prog{position:absolute;width:100%;text-align:center;line-height:40px;color:white;font-weight:bold;font-size:24px;text-shadow:1px 1px 3px #000;}
  .score{text-align:center;font-size:28px;margin:10px;}

  .main-area{flex:1;display:flex;align-items:center;justify-content:center;gap:40px;padding:20px;}
  .qnum{font-size:120px;font-weight:bold;color:#003087;}
  .qtext{font-size:46px;line-height:1.4;max-width:70%;text-align:left;}

  .working-area{width:100%;max-width:900px;margin:20px auto;}
  .working-label{text-align:center;font-size:26px;margin-bottom:8px;font-weight:bold;}
  .working{border:4px dotted #003087;background:#f8fbff;border-radius:10px;height:180px;padding:15px;}
  #working{width:100%;height:100%;border:none;background:transparent;font-size:26px;resize:none;outline:none;}

  #answer-input{width:90%;max-width:500px;height:90px;font-size:48px;text-align:center;border:4px solid black;border-radius:12px;margin:30px auto;display:block;}
  .btn-area{text-align:center;}
  .end-btn{background:#c00 !important;}

  #feedback{text-align:center;font-size:42px;margin:20px;min-height:60px;}

  .hidden{display:none !important;}

  /* Mobile adjustments */
  @media (max-width: 768px) {
    .ks2{font-size:28px;padding:10px 40px;}
    .title{font-size:42px;}
    .subtitle{font-size:24px;}
    .name-box input{font-size:24px;padding:16px;}
    button{font-size:24px;padding:16px;}
    #timer{font-size:36px;}
    .qnum{font-size:90px;}
    .qtext{font-size:36px;text-align:center;max-width:90%;}
    #working{font-size:22px;}
    #answer-input{height:75px;font-size:40px;}
    .prog{font-size:20px;}
  }
</style>
</head>
<body>

<div id="welcome" class="page">
  <div class="header">2026 national curriculum tests</div>
  <div style="text-align:center;margin-top:30px;"><div class="ks2">Key stage 2</div></div>
  <div class="title">Mathematics</div>
  <button class="big-btn" onclick="go('arithmetic')">Paper 1: arithmetic<br><small>40 questions • 30 minutes</small></button>
  <button class="big-btn" onclick="go('reasoning')">Paper 2 / Paper 3: reasoning<br><small>35 questions • 40 minutes</small></button>
</div>

<div id="cover" class="page hidden">
  <div class="header">2026 national curriculum tests</div>
  <div style="text-align:center;margin-top:25px;"><div class="ks2">Key stage 2</div></div>
  <div class="title">Mathematics</div>
  <div class="subtitle" id="papertitle"></div>
  <div class="name-box">
    <input type="text" id="name" placeholder="Enter your full name here" autocomplete="off">
  </div>
  <button class="big-btn" onclick="start()">Start Test</button>
</div>

<div id="game" class="page hidden">
  <div class="header">2026 national curriculum tests</div>
  <div style="text-align:center;"><div class="ks2">Key stage 2</div></div>
  <div id="timer">40:00</div>
  <div class="progress"><div class="bar" id="bar"><div class="prog" id="prog">0 / 35</div></div></div>
  <div class="score">Score: <strong id="score">0</strong> / <strong id="total">35</strong></div>

  <div class="main-area">
    <div class="qnum" id="qnum">1</div>
    <div class="qtext" id="question"></div>
  </div>

  <div class="working-area">
    <div class="working-label">Show your working</div>
    <div class="working"><textarea id="working"></textarea></div>
  </div>

  <input type="text" id="answer-input" placeholder="Answer">

  <div class="btn-area">
    <button onclick="check()">Submit Answer</button>
    <button class="end-btn" onclick="end()">End Test Early</button>
  </div>
  <div id="feedback"></div>
</div>

<div id="endpage" class="page hidden">
  <div class="header">2026 national curriculum tests</div>
  <div style="text-align:center;margin-top:60px;"><div class="ks2">Key stage 2</div></div>
  <div style="text-align:center;margin-top:100px;">
    <h1 style="font-size:70px;">Test Complete!</h1>
    <h1 style="font-size:110px;color:#005eb8;" id="final">0 / 35</h1>
    <h2 style="font-size:48px;" id="msg"></h2>
    <button style="background:#27ae60;font-size:32px;padding:20px 80px;" onclick="pdf()">Save as PDF</button><br><br>
    <button onclick="location.reload()">Back to Menu</button>
  </div>
</div>

<script>
const { jsPDF } = window.jspdf;
let q=0, score=0, timeLeft, timer, name="", work=[], paper=[], type="";

const reasoningBank = [
  {t:"15% of 240 =",a:"36",m:1},
  {t:"A shop has an offer.<br>Buy one box for £1.90<br>Get the second box half price.<br>Ali buys two boxes.<br>How much must he pay altogether?",a:"2.85",m:1},
  {t:"24 × 18 =",a:"432",m:2},
  {t:"528 ÷ 12 =",a:"44",m:1},
  {t:"Film starts 6:45pm and lasts 2 hours 35 minutes.<br>What time does it finish?",a:"9:20",m:2},
  {t:"456 × 7 =",a:"3192",m:2},
  {t:"12.5% of 800 =",a:"100",m:1},
  {t:"Point (3,5) translated 4 right, 2 up =",a:"(7,7)",m:2},
  {t:"Volume of cuboid 6 × 4 × 5 cm =",a:"120",m:2},
  {t:"3/5 of 45 =",a:"27",m:1},
  {t:"0.4 × 0.7 =",a:"0.28",m:1},
  {t:"Area of triangle: base 12cm, height 8cm =",a:"48",m:2},
  {t:"350 car park spaces, 70% full =",a:"245",m:2},
  // Add more real past questions here!
];

function go(t){
  type = t;
  document.getElementById('welcome').classList.add('hidden');
  document.getElementById('cover').classList.remove('hidden');
  document.getElementById('papertitle').innerHTML = t==='arithmetic' ? 'Paper 1: arithmetic' : 'Paper 2 / Paper 3: reasoning';
}

function start(){
  name = document.getElementById('name').value.trim() || "Student";
  paper = type==='arithmetic' ? genArith() : shuffle([...reasoningBank]).slice(0,35);
  timeLeft = type==='arithmetic'?1800:2400;
  document.getElementById('total').textContent = paper.length;
  document.getElementById('cover').classList.add('hidden');
  document.getElementById('game').classList.remove('hidden');
  q=0; score=0; work=[];
  loadQ(); startTimer();
}

function genArith(){
  let a = [];
  for(let i=1;i<=40;i++){
    let x = Math.floor(Math.random()*8999)+1001;
    let y = i<=20 ? Math.floor(Math.random()*899)+101 : Math.floor(Math.random()*89)+11;
    a.push({t:(i<=20?x+" + "+y+" =":x+" × "+y+" ="), a:(i<=20?x+y:x*y).toString(), m:1});
  }
  return a;
}

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    let j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function startTimer(){
  timer = setInterval(()=>{
    timeLeft--;
    let m = Math.floor(timeLeft/60), s = timeLeft%60;
    document.getElementById('timer').textContent = m+":"+(s<10?"0":"")+s;
    if(timeLeft<=0) end();
  },1000);
}

function loadQ(){
  if(q >= paper.length) return end();
  document.getElementById('qnum').textContent = q+1;
  document.getElementById('question').innerHTML = paper[q].t;
  document.getElementById('answer-input').value = '';
  document.getElementById('working').value = '';
  document.getElementById('feedback').innerHTML = '';
}

function check(){
  let userAns = document.getElementById('answer-input').value.trim().toLowerCase();
  let correct = paper[q].a.toString().toLowerCase();
  let correctBool = userAns === correct;
  work.push({q:q+1, question:paper[q].t, working:document.getElementById('working').value, ok:correctBool});

  if(correctBool){
    score += paper[q].m || 1;
    confetti({particleCount:300, spread:100, origin:{y:0.6}});
    document.getElementById('feedback').innerHTML = '<span style="color:green;">Correct!</span>';
  } else {
    document.getElementById('feedback').innerHTML = `<span style="color:red;">Incorrect – answer: ${paper[q].a}</span>`;
  }

  document.getElementById('score').textContent = score;
  document.getElementById('prog').textContent = (q+1)+"/"+paper.length;
  document.getElementById('bar').style.width = ((q+1)/paper.length*100)+"%";
  q++;
  setTimeout(loadQ, correctBool?1200:3500);
}

function end(){
  clearInterval(timer);
  document.getElementById('game').classList.add('hidden');
  document.getElementById('endpage').classList.remove('hidden');
  document.getElementById('final').textContent = score + " / " + paper.length;
  document.getElementById('msg').textContent = 
    score <= 25 ? "Great effort – keep practising!" :
    score <= 30 ? "So close to Greater Depth!" :
    "Greater Depth ACHIEVED! Amazing work!";
}

function pdf(){
  const doc = new jsPDF();
  doc.setFontSize(20);
  doc.text("SATs Results – " + name, 105, 20, {align:"center"});
  doc.text("Score: " + score + " / " + paper.length, 105, 35, {align:"center"});
  let y = 50;
  work.forEach(w => {
    if(y > 270){ doc.addPage(); y = 20; }
    doc.setFontSize(10);
    doc.text(`Q${w.q}: ${w.ok?"Correct":"Incorrect"}`, 15, y);
    doc.text(doc.splitTextToSize(w.question.replace(/<br>/g," "), 180), 20, y+8);
    if(w.working) doc.text("Working: "+w.working.substring(0,180), 20, y+20);
    y += 35;
  });
  doc.save(name + "_SATs_2026.pdf");
}
</script>
</body>
</html>
